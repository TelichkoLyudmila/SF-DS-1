# 5. Задача регрессии, предсказание продолительности поездки такси для Kaggle

## Оглавление  
1. Описание проекта
2. Какой кейс решаем? 
3. Краткая информация о данных 
4. Этапы работы над проектом
5. Результат  
6. Выводы

### Описание проекта    
  
Задачу машинного обучения направлена на автоматизацию бизнес процессов. Необходимо построить модель, которая будет предсказывать общую продолжительность поездки такси в Нью-Йорке. 

Время поездки зависит от множества факторов таких как, откуда и куда поездка, в какое время суток совершается, погодных условий и так далее. Таким образом, необходимо разработать алгоритм, способный определять длительность поездки, и сможем прогнозировать ее стоимость самым тривиальным образом, например, просто умножая стоимость на заданный тариф. 
Сервисы такси хранят огромные объёмы информации о поездках, включая такие данные как конечная, начальная точка маршрута, дата поездки и ее длительность. Эти данные можно использовать для того, чтобы прогнозировать длительность поездки в автоматическом режиме с привлечением искусственного интеллекта.

### Какой кейс решаем?    
Построить модель машинного обучения, которая на основе предложенных характеристик клиента будет предсказывать числовой признак - время поездки такси. То есть решить задачу регрессии. 

**Условия соревнования:**  
Необходимо определить характеристики и с их помощью спрогнозировать длительность поездки такси

**Метрика качества**     
RMSLE

**Что практикуем**     
Feature engineering, методы машинного обучения, выбор моделей

### Краткая информация о данных
Данные Kaggle сореванования:
https://www.kaggle.com/competitions/nyc-taxi-trip-duration/discussion/39553

Признаки:
Данные о клиенте и таксопарке:
* id - уникальный идентификатор поездки
* vendor_id - уникальный идентификатор поставщика (таксопарка), связанного с записью поездки

Временные характеристики:
* pickup_datetime - дата и время, когда был включен счетчик поездки
* dropoff_datetime - дата и время, когда счетчик был отключен

Географическая информация:
* pickup_longitude -  долгота, на которой был включен счетчик
* pickup_latitude - широта, на которой был включен счетчик
* dropoff_longitude - долгота, на которой счетчик был отключен
* dropoff_latitude - широта, на которой счетчик был отключен

Прочие признаки:
* passenger_count - количество пассажиров в транспортном средстве (введенное водителем значение)
* store_and_fwd_flag - флаг, который указывает, сохранилась ли запись о поездке в памяти транспортного средства перед отправкой поставщику. Y - хранить и пересылать, N - не хранить и не пересылать поездку.

Целевой признак:
* trip_duration - продолжительность поездки в секундах


### Этапы работы над проектом  
1. Сформировать набор данных на основе нескольких источников информации
2. Спроектировать новые признаки с помощью Feature Engineering и выявить наиболее значимые при построении модели
3. Исследовать предоставленные данные и выявить закономерности
4. Построить несколько моделей и выбрать из них наилучшую по заданной метрике
5. Спроектировать процесс предсказания времени длительности поездки для новых данных

### Результаты:  
Лучшие результаты получены в итоге модели Gradient Boosting

|	|model	                            |RMSLE_train_score	|RMSLE_valid_score |
|--	|---------------------------------- |:-----------------:| ----------------:|
|0	|Linear regression	                |0.54	            |0.54			   |	
|1	|Poly skylearn	                    |0.47	            |0.70			   |	
|2	|Poly skylearn+L2	                |0.48	            |0.48			   |	
|3	|DecisionTreeRegressor	            |0.00	            |0.57			   |	
|4	|DecisionTreeRegressor - maxd11	    |0.41	            |0.43			   |	
|5	|Random Forest	                    |0.40	            |0.41			   |	
|6	|GradientBoostingRegressor	        |0.37	            |0.39			   |	


### Выводы:  
Ошибка RMSLE на тренинговом наборе kaggle составила менее 0.4 с использованием модели градиентного бустинга