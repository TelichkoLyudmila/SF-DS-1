# Прогноз оттока клиентов в банке - задача классификации

## Оглавление  
1. Описание проекта
2. Какой кейс решаем? 
3. Краткая информация о данных
4. Этапы работы над проектом
5. Результат  
6. Выводы

### Описание проекта    
Некоторый банк хочет разработать кампанию лояльности по удержанию клиентов. Для этого он хочет прогнозировать вероятности оттока клиентов и определять, уйдёт ли клиент в ближайшее время. 

### Какой кейс решаем?    
Задача: построить классификатор, который позволит своевременно определять уходящих клиентов банка, оценить качество построенных моделей и проинтерпретировать результаты.

**Условия соревнования:**  
Лучший показатель метрики

**Метрика качества**     
Будем использовать F1 — это взвешенное среднее гармоническое между precision и recall. Precision — показывает, как много из предсказанных положительных объектов на самом деле являются положительными, a recall — показывает, как много положительных объектов модель нашла среди всех положительных объектов. 

Чем ближе precision к 1, тем меньше вероятность модели допустить ошибку I рода, а чем ближе recall к 1, тем меньше вероятность модели допустить ошибку II рода. Таким образом взвешенная F1 позволит найти точку, где будет допущена минимальная совокупная ошибка I и II рода

**Что практикуем**     
Feature engineering, классификация: логистическая, полиномиальная регрессия, деревья решений, случайный лес, подбор порога вероятности

### Краткая информация о данных
Данные представляют собой таблицу в формате CSV:

- RowNumber — номер строки;
- CustomerId — ID клиента;
- Surname — фамилия клиента;
- CreditScore — кредитный рейтинг;
- Geography — страна локации клиента;
- Gender — пол клиента;
- Age — возраст клиента;
- Tenure — время пользования услугами банка;
- Balance — текущий баланс по счету;
- NumOfProducts — число используемых продуктов;
- HasCrCard — есть ли кредитная карта;
- IsActiveMember — пользуется ли продуктами банка чаще раза в месяц;
- EstimatedSalary — ожидаемая заработная плата;
- Exited — целевая переменная - ушел клиент или остался.


### Этапы работы над проектом  
1. Разведывательный анализ данных
2. Предобработка данных
3. Выбор метрики
4. Логистическая регрессия
5. Полиномиальная регрессия
6. Деревья решений и случайный лес

### Результаты:  

По итогам с помозью случайного леса при подходящем пороговом значении удалось добиться такой же метрики 0.7 для F1, как и в полиномиальной регрессии. Показатель precision стал чуть выше (в полин - 0.6), а recall ниже (в полин - 0.84). Они стали чуть ближе, что лучше для модели: более высокий Precision говорит о том, что у нас меньше вероятность модели допустить ошибку I рода, т.е. записать в ушедших лояльных клиентов. Небольшое снижение recall говорит о том, что вероятность модели допустить ошибку II рода стала выше, т.е. не "отловить" клиентов, которые планируют уйти из банка и ошибочно занести их к лояльным. Однако показатель метрики все еще достаточно велик.

### Выводы:  

Лучшие результаты показали полиномиальная регрессия и случайный лес. Показатель precision во втором случае стал чуть выше, а recall ниже. В зависимости от целей банка можно использовать одну из этих двух моделей

